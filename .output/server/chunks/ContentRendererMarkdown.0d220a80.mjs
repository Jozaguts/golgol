import{defineComponent as t,h as e,Text as r,resolveComponent as o,useSSRContext as n}from"vue";import i from"destr";import{pascalCase as p}from"scule";import{find as s,html as a}from"property-information";import u from"html-tags";import{c as m,u as c}from"./server.mjs";import"ohmyfetch";import"hookable";import"unctx";import"ufo";import"h3";import"defu";import"vue-router";import"vue/server-renderer";import"@iconify/vue/dist/offline";import"@iconify/vue";import"ohash";import"cookie-es";import"lodash-es";import"@formkit/auto-animate";import"./node-server.mjs";import"node-fetch-native/polyfill";import"http";import"https";import"unenv/runtime/fetch/index";import"unstorage";import"unstorage/drivers/overlay";import"unstorage/drivers/memory";import"radix3";import"fs";import"pathe";import"url";import"unified";import"mdast-util-to-string";import"micromark/lib/preprocess.js";import"micromark/lib/postprocess.js";import"unist-util-stringify-position";import"micromark-util-character";import"micromark-util-chunked";import"micromark-util-resolve-all";import"remark-emoji";import"rehype-slug";import"remark-squeeze-paragraphs";import"rehype-external-links";import"remark-gfm";import"rehype-sort-attribute-values";import"rehype-sort-attributes";import"rehype-raw";import"remark-mdc";import"remark-parse";import"remark-rehype";import"mdast-util-to-hast";import"detab";import"unist-builder";import"mdurl";import"slugify";import"unist-util-position";const l=/^@|^v-on:/,d=/^:|^v-bind:/,f=/^v-model/,v=["select","textarea","input"],y=t({name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})}},async setup(t){var e;const{content:{tags:r={}}}=m().public;return await async function(t,e){const r=Array.from(new Set(loadComponents(t,e)));function loadComponents(t,e){var r;if("text"===t.type||"binding"===t.tag)return[];const o=void 0===(null==(r=t.props)?void 0:r.__ignoreMap)&&e.tags[t.tag]||t.tag,n=[];"root"===t.type||u.includes(o)||n.push(o);for(const r of t.children||[])n.push(...loadComponents(r,e));return n}await Promise.all(r.map((async t=>{const e=o(t);(null==e?void 0:e.__asyncLoader)&&!e.__asyncResolved&&await e.__asyncLoader()})))}(t.value.body,{tags:{...r,...(null==(e=t.value)?void 0:e._components)||{},...t.components}}),{tags:r}},render(t){var r;const{tags:o,tag:n,value:i,components:p}=t;if(!i)return null;let s=i.body||i;t.excerpt&&i.excerpt&&(s=i.excerpt);const a={...i,tags:{...o,...(null==i?void 0:i._components)||{},...p}};let u=a.component||n;"object"==typeof a.component&&(u=a.component.name),u=resolveVueComponent(u);const m=(s.children||[]).map((t=>renderNode(t,e,a)));return e(u,{...null==(r=a.component)?void 0:r.props,...this.$attrs},{default:createSlotFunction(m)})}});function renderNode(t,e,o,n={}){var i;if("text"===t.type)return e(r,t.value);const p=t.tag,u=void 0===(null==(i=t.props)?void 0:i.__ignoreMap)&&o.tags[p]||p;if("binding"===t.tag)return function(t,e,o,n={}){var i;const p={...n,$route:()=>c(),$document:o,$doc:o},s=/\.|\[(\d+)\]/,a=(null==(i=t.props)?void 0:i.value.trim().split(s).filter(Boolean)).reduce(((t,e)=>e in t?"function"==typeof t[e]?t[e]():t[e]:{}),p);return e(r,a)}(t,e,o,n);const m=resolveVueComponent(u);"object"==typeof m&&(m.tag=p);const y=function(t,e){const{tag:r="",props:o={}}=t;return Object.keys(o).reduce((function(t,n){if("__ignoreMap"===n)return t;const i=o[n];if(f.test(n)&&!v.includes(r))return function(t,e,r,o){const number=t=>+t,trim=t=>t.trim(),noop=t=>t,n=t.replace(f,"").split(".").filter((t=>t)).reduce(((t,e)=>(t[e]=!0,t)),{}),i="value",p=n.lazy?"change":"input",s=n.number?number:n.trim?trim:noop;return r[i]=evalInContext(e,o),r.on=r.on||{},r.on[p]=t=>o[e]=s(t),r}(n,i,t,e);if("v-bind"===n)return function(t,e,r,o){const n=evalInContext(e,o);return r=Object.assign(r,n)}(0,i,t,e);if(l.test(n))return function(t,e,r,o){return t=t.replace(l,""),r.on=r.on||{},r.on[t]=()=>evalInContext(e,o),r}(n,i,t,e);if(d.test(n))return function(t,e,r,o){return t=t.replace(d,""),r[t]=evalInContext(e,o),r}(n,i,t,e);const{attribute:p}=s(a,n);return Array.isArray(i)&&i.every((t=>"string"==typeof t))?(t[p]=i.join(" "),t):(t[p]=i,t)}),{})}(t,o);return e(m,y,function(t,e,r,o){const n=(t.children||[]).reduce(((t,n)=>{if(!isTemplate(n))return t.default.push(renderNode(n,e,r,o)),t;if(function(t){return isTemplate(t)&&"default"===getSlotName(t)}(n))return t.default.push(...(n.children||[]).map((t=>renderNode(t,e,r,o)))),t;return t[getSlotName(n)]=(n.children||[]).map((t=>renderNode(t,e,r,o))),t}),{default:[]}),i=Object.entries(n).map((([t,e])=>[t,createSlotFunction(e)]));return Object.fromEntries(i)}(t,e,o,{...n,...y}))}const resolveVueComponent=t=>{if(!u.includes(t)){const e=o(p(t),!1);if("object"==typeof e)return e}return t};function evalInContext(t,e){const r=t.split(".").reduce(((t,e)=>"object"==typeof t?t[e]:void 0),e);return void 0===r?i(t):r}function getSlotName(t){let e="";for(const r of Object.keys(t.props||{}))if(r.startsWith("#")||r.startsWith("v-slot:")){e=r.split(/[:#]/,2)[1];break}return e||"default"}function createSlotFunction(t){return t.length?()=>function(t){const e=[];for(const o of t){const t=e[e.length-1];o.type===r&&(null==t?void 0:t.type)===r?t.children=t.children+o.children:e.push(o)}return e}(t):void 0}function isTemplate(t){return"template"===t.tag}const h=y.setup;y.setup=(t,e)=>{const r=n();return(r.modules||(r.modules=new Set)).add("node_modules/@nuxt/content/dist/runtime/components/ContentRendererMarkdown.vue"),h?h(t,e):void 0};export{y as default};
//# sourceMappingURL=ContentRendererMarkdown.0d220a80.mjs.map
